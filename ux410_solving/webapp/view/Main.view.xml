<mvc:View controllerName="sap.btp.ux410solving.controller.Main"
    xmlns:f="sap.f"
    xmlns:core="sap.ui.core"
    xmlns:fb="sap.ui.comp.filterbar"
    xmlns:layout="sap.ui.layout"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m">
    <Page id="page" title="{i18n>title}">
        <content >
            <f:DynamicPage id="dynamicPageId" preserveHeaderStateOnScroll="true" headerExpanded="{/headerExpanded}" showFooter="true" fitContent="true">
			<!-- DynamicPage Title -->
			<f:title>
				<f:DynamicPageTitle>
					<f:heading>
						<Title text="VizFrame"/>
					</f:heading>									
				</f:DynamicPageTitle>
			</f:title>

			<!-- DynamicPage Header -->
			<f:header>
				<f:DynamicPageHeader>
					<f:content>
						<fb:FilterBar 
                            id="idFilterbar" 
                            persistencyKey="myPersKey" 
                            useToolbar="false" 
                            search=".onSearch" 
                            filterChange=".onFilterChange" 
                            afterVariantLoad=".onAfterVariantLoad">
							<fb:filterGroupItems>
								<fb:FilterGroupItem name="OrderID" label="OrderID" groupName="Group1" visibleInFilterBar="true">
									<fb:control>
										<ComboBox
                                            showSecondaryValues= "true"
											name="OrderID"
                                            id="idCombo1"
											items="{
												path: '/Orders',
												templateShareable: true
											}"
										>
											<core:ListItem key="{OrderID}" text="{OrderID}" additionalText="{CustomerID}"/>
										</ComboBox>                                        
									</fb:control>
								</fb:FilterGroupItem>
								<fb:FilterGroupItem name="Type" label="Type" groupName="Group2" visibleInFilterBar="true">
									<fb:control>
										<ComboBox
                                            required="true"
											name="Type"
                                            id="idCombo2"
                                            value="bar"
											items="{
												path: 'typeList>/type',
												templateShareable: true                                    
											}"
										>
											<core:ListItem key="{typeList>typeName}" text="{typeList>typeName}"/>
										</ComboBox>                                        
									</fb:control>
								</fb:FilterGroupItem>
							</fb:filterGroupItems>
						</fb:FilterBar>
					</f:content>
				</f:DynamicPageHeader>
			</f:header>

			<f:content>
				<!-- chart 여기에  -->
                <viz:VizFrame id="idBarChart" width="100%" height="100%"
                    vizType="bar"
                    uiConfig="{ 'applicationSet': 'fiori' }"
                    vizProperties="{
                        'title': { 'visible': true, 'text': '' },
                        'legendGroup': {
                            'layout': { 'position': 'right' }
                        },
                        'plotArea': {
                            'dataLabel': { 'visible': true, 'type': 'value' }
                        }
                    }"
                    selectData="onDatasetSelected"
                    >
                    <viz:dataset>
                            <viz.data:FlattenedDataset data="{/Order_Details}">
                                <!-- x축 -->
                                <viz.data:dimensions>
                                    <viz.data:DimensionDefinition name="OrderID" value="{OrderID}"/>
                                    <viz.data:DimensionDefinition name="ProductID" value="{ProductID}"/>
                                </viz.data:dimensions>

                                <!-- y축 -->
                                <viz.data:measures>
                                    <viz.data:MeasureDefinition name="UnitPrice" value="{UnitPrice}"/>
                                </viz.data:measures>
                            </viz.data:FlattenedDataset>
                    </viz:dataset>
                    
                    
                    <viz:feeds >
                            <viz.feeds:FeedItem uid="categoryAxis" type="Dimension" values="OrderID,ProductID" />
                            <viz.feeds:FeedItem uid="valueAxis" type="Measure" values="UnitPrice" />
                    </viz:feeds>
                </viz:VizFrame>
			</f:content>
			
		</f:DynamicPage>

        </content>    
    </Page>
</mvc:View>
